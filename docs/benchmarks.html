<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="RhinoWAF Benchmarks - Performance and attack detection metrics">
    <title>Benchmarks - RhinoWAF</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <nav>
            <div class="container">
                <div class="logo">RhinoWAF</div>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="features.html">Features</a></li>
                    <li><a href="benchmarks.html">Benchmarks</a></li>
                    <li><a href="docs.html">Docs</a></li>
                    <li><a href="comparison.html">Compare</a></li>
                    <li><a href="https://github.com/1rhino2/RhinoWAF">GitHub</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <section class="page-header">
        <div class="container">
            <h1>Performance Benchmarks</h1>
            <p>Tested on AMD Ryzen 5 3600X, 16GB RAM</p>
        </div>
    </section>

    <section class="content">
        <div class="container">
            <h2>Attack Detection Results</h2>
            <table>
                <thead>
                    <tr>
                        <th>Attack Type</th>
                        <th>Tests</th>
                        <th>Detection Rate</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SQL Injection</td>
                        <td>146</td>
                        <td>89.86%</td>
                        <td>39 categories: union, boolean, time-based, stacked queries, NoSQL, obfuscation, privilege escalation, batch queries, encoding bypasses</td>
                    </tr>
                    <tr>
                        <td>XSS Attacks</td>
                        <td>86</td>
                        <td>100%</td>
                        <td>DOM-based, mutation XSS, HTML5 vectors, 24 event handlers, SVG/XML attacks, CSS injection, template injection, encoding bypasses</td>
                    </tr>
                    <tr>
                        <td>Header Injection</td>
                        <td>35</td>
                        <td>93.10%</td>
                        <td>CRLF injection, HTTP smuggling (CL-TE/TE-CL), header pollution, cache poisoning, authorization bypass headers</td>
                    </tr>
                    <tr>
                        <td>Form Sanitization</td>
                        <td>43</td>
                        <td>85%</td>
                        <td>Path traversal, command injection, LDAP injection, NoSQL injection, SSRF, template injection (SSTI), XXE, file uploads</td>
                    </tr>
                    <tr>
                        <td>HTTP Smuggling</td>
                        <td>17</td>
                        <td>95%</td>
                        <td>Content-Length/Transfer-Encoding conflicts, header splitting, request smuggling variants</td>
                    </tr>
                    <tr>
                        <td>Bot Traffic</td>
                        <td>Multiple</td>
                        <td>70-99%</td>
                        <td>Challenge system with JS, PoW, hCaptcha, Turnstile options</td>
                    </tr>
                    <tr>
                        <td><strong>Overall Average</strong></td>
                        <td><strong>327+</strong></td>
                        <td><strong>90.49%</strong></td>
                        <td><strong>Enterprise-grade penetration testing patterns</strong></td>
                    </tr>
                </tbody>
            </table>

            <div class="doc-section">
                <h3>Test Coverage Details</h3>
                <ul>
                    <li><strong>SQL Injection (146 tests):</strong> Union-based, boolean blind, time-based blind, error-based, stacked queries, order by enumeration, comment variations, encoding bypasses, case manipulation, advanced functions (xp_cmdshell, INTO OUTFILE), privilege escalation, NoSQL operators, batch queries, database fingerprinting, out-of-band exfiltration, double encoding, tautologies, truncation attacks, JSON/GraphQL/XML injection, HTTP parameter pollution, polyglot attacks, type juggling, stored procedures, charset manipulation</li>
                    <li><strong>XSS Attacks (86 tests):</strong> Basic script tags, event handlers (onerror, onload, onmouseover, onfocus, onanimationend, ontransitionend, etc.), JavaScript/vbscript/data/file protocols, HTML5 vectors (video, audio, form, link, meta), SVG attacks, CSS injection (expression, @import, behavior), DOM-based patterns, XML/XHTML vectors, template injection (Angular, React, Vue), encoding bypasses (Unicode, hex, HTML entities), polyglot attacks, mutation XSS, framework-specific vectors</li>
                    <li><strong>Header Injection (35 tests):</strong> CRLF injection (basic, URL-encoded, double-encoded), HTTP request smuggling (CL-TE, TE-CL), header pollution (duplicate Host, X-Forwarded-For), cache poisoning, authorization bypass (X-Original-URL, X-Rewrite-URL), XSS via headers, command injection in User-Agent/Via</li>
                    <li><strong>Form Sanitization (43 tests):</strong> Path traversal (directory traversal, Windows paths, encoded), command injection (shell metacharacters, backticks, $(), Shellshock), LDAP injection, XML/XXE attacks, SSRF (localhost, internal IPs, cloud metadata), template injection (Jinja2, ERB, OGNL), NoSQL injection (MongoDB operators), file upload attacks, CRLF in forms, expression language injection</li>
                </ul>
            </div>

            <h2>Throughput Performance</h2>
            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Value</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Max Requests/Second</td>
                        <td>10,000-50,000</td>
                        <td>Depends on config and cores</td>
                    </tr>
                    <tr>
                        <td>WAF Processing Time</td>
                        <td>0.15ms</td>
                        <td>Per request overhead</td>
                    </tr>
                    <tr>
                        <td>Memory per Request</td>
                        <td>350KB</td>
                        <td>With full middleware stack</td>
                    </tr>
                    <tr>
                        <td>False Positive Rate</td>
                        <td>0%</td>
                        <td>Zero false positives in 327+ test cases</td>
                    </tr>
                    <tr>
                        <td>CPU Usage</td>
                        <td>~5-15%</td>
                        <td>During active traffic</td>
                    </tr>
                </tbody>
            </table>

            <h2>IPv6 Operation Performance</h2>
            <table>
                <thead>
                    <tr>
                        <th>Operation</th>
                        <th>Time (ns/op)</th>
                        <th>Allocations</th>
                        <th>Bytes/op</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>IsIPv6 Check</td>
                        <td>43.98</td>
                        <td>0</td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td>IP Normalization</td>
                        <td>191.4</td>
                        <td>1</td>
                        <td>32</td>
                    </tr>
                    <tr>
                        <td>Version Detection</td>
                        <td>43.03</td>
                        <td>0</td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td>CIDR Matching</td>
                        <td>&lt;200</td>
                        <td>1</td>
                        <td>32</td>
                    </tr>
                </tbody>
            </table>

            <h2>Smuggling Detection Performance</h2>
            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Detection Overhead</td>
                        <td>&lt;0.5ms per request</td>
                    </tr>
                    <tr>
                        <td>Memory Usage</td>
                        <td>Minimal (pre-compiled regexes)</td>
                    </tr>
                    <tr>
                        <td>CPU Impact</td>
                        <td>Negligible</td>
                    </tr>
                    <tr>
                        <td>Throughput Impact</td>
                        <td>No measurable impact</td>
                    </tr>
                </tbody>
            </table>

            <h2>Challenge System Performance</h2>
            <table>
                <thead>
                    <tr>
                        <th>Challenge Type</th>
                        <th>Solve Time</th>
                        <th>Bot Block Rate</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>JavaScript</td>
                        <td>2 seconds</td>
                        <td>~70%</td>
                    </tr>
                    <tr>
                        <td>Proof-of-Work (diff 4)</td>
                        <td>1-5 seconds</td>
                        <td>~85%</td>
                    </tr>
                    <tr>
                        <td>Proof-of-Work (diff 5)</td>
                        <td>10-30 seconds</td>
                        <td>~95%</td>
                    </tr>
                    <tr>
                        <td>hCaptcha</td>
                        <td>3-10 seconds</td>
                        <td>~99%</td>
                    </tr>
                    <tr>
                        <td>Turnstile</td>
                        <td>~2 seconds</td>
                        <td>~95%</td>
                    </tr>
                </tbody>
            </table>

            <h2>Fingerprinting Performance</h2>
            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>First Visit Overhead</td>
                        <td>1-2 seconds (collection page)</td>
                    </tr>
                    <tr>
                        <td>Subsequent Visits</td>
                        <td>&lt;5ms (cookie validation)</td>
                    </tr>
                    <tr>
                        <td>Memory per Fingerprint</td>
                        <td>~1KB</td>
                    </tr>
                    <tr>
                        <td>Bot Network Detection</td>
                        <td>Real-time</td>
                    </tr>
                </tbody>
            </table>

            <h2>Run Benchmarks Yourself</h2>
            <div class="doc-section">
                <p>All benchmarks are reproducible. To run the comprehensive test suite:</p>
                <pre># Run all attack detection tests
go test -v -run="TestSQLInjectionComprehensive|TestXSSDetection|TestHeaderInjection|TestPOSTFormSanitization" ./benchmarks

# Run performance benchmarks
go test -bench=. -benchmem -benchtime=3s ./benchmarks</pre>
                <p>Or use the automated PowerShell script that runs all tests:</p>
                <pre>.\benchmarks\run_benchmarks.ps1</pre>
                <p>This will generate detailed reports including:</p>
                <ul>
                    <li>SQL injection detection (146 tests across 39 categories)</li>
                    <li>XSS detection (86 tests with advanced evasion techniques)</li>
                    <li>Header injection detection (35 tests including smuggling)</li>
                    <li>Form sanitization (43 tests covering multiple attack types)</li>
                    <li>Performance metrics (throughput, latency, memory usage)</li>
                    <li>Middleware overhead measurements</li>
                </ul>
                <p>Results will vary based on your hardware, Go version, and system load. See <code>benchmarks/</code> directory for details.</p>
            </div>

            <h2>Test Environment</h2>
            <div class="doc-section">
                <h3>Hardware</h3>
                <ul>
                    <li>CPU: AMD Ryzen 5 3600X (6 cores, 12 threads)</li>
                    <li>RAM: 16GB DDR4</li>
                    <li>Storage: NVMe SSD</li>
                </ul>

                <h3>Software</h3>
                <ul>
                    <li>Go 1.21+</li>
                    <li>Linux kernel 5.15+</li>
                    <li>RhinoWAF v2.5</li>
                </ul>

                <h3>Test Methodology</h3>
                <ul>
                    <li>Enterprise-grade penetration testing patterns from OWASP and real-world attacks</li>
                    <li>327+ test cases covering SQL injection, XSS, header injection, form attacks, and more</li>
                    <li>Advanced evasion techniques: encoding bypasses, polyglot attacks, mutation vectors</li>
                    <li>Zero tolerance for false positives - all legitimate inputs pass</li>
                    <li>Go benchmark suite with concurrent request testing</li>
                    <li>Middleware overhead measurements with -benchmem allocation tracking</li>
                    <li>Automated test execution: <code>go test -v ./benchmarks</code></li>
                    <li>Full test suite available in <code>benchmarks/</code> directory</li>
                </ul>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>RhinoWAF - Open Source Web Application Firewall</p>
            <p>Licensed under AGPL-3.0 | <a href="https://github.com/1rhino2/RhinoWAF">GitHub</a> | <a href="https://github.com/1rhino2/RhinoWAF/issues">Report Issues</a></p>
        </div>
    </footer>
</body>
</html>